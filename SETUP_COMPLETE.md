# üéâ AWS S3 / DigitalOcean Spaces - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!

## ‚úÖ –°—Ç–∞—Ç—É—Å: –ü–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ!

### üîß –ß—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:

1. ‚úÖ **DigitalOcean Space —Å–æ–∑–¥–∞–Ω**: `arcast-s3` –≤ —Ä–µ–≥–∏–æ–Ω–µ `blr1`
2. ‚úÖ **CDN –≤–∫–ª—é—á–µ–Ω**: `https://arcast-s3.blr1.cdn.digitaloceanspaces.com`
3. ‚úÖ **–ö–ª—é—á–∏ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã**: —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏
4. ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞**: –¥–ª—è —Ä–µ–≥–∏–æ–Ω–∞ `blr1`
5. ‚úÖ **–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ**: —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –≤ Space:

```
arcast-s3/
‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îú‚îÄ‚îÄ studios/          # –§–æ—Ç–æ —Å—Ç—É–¥–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ blog/            # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –±–ª–æ–≥–∞
‚îÇ   ‚îî‚îÄ‚îÄ equipment/        # –§–æ—Ç–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ videos/
‚îÇ   ‚îú‚îÄ‚îÄ samples/         # –í–∏–¥–µ–æ –æ–±—Ä–∞–∑—Ü—ã
‚îÇ   ‚îî‚îÄ‚îÄ content/         # –í–∏–¥–µ–æ –∫–æ–Ω—Ç–µ–Ω—Ç
‚îú‚îÄ‚îÄ audio/
‚îÇ   ‚îî‚îÄ‚îÄ recordings/       # –ê—É–¥–∏–æ –∑–∞–ø–∏—Å–∏
‚îî‚îÄ‚îÄ documents/
    ‚îî‚îÄ‚îÄ contracts/      # –î–æ–∫—É–º–µ–Ω—Ç—ã
```

### üöÄ API Endpoints –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:

#### –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:

- **–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–æ—Ä–º—ã —Å—Ç—É–¥–∏–π** (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç S3)
- **URL**: `POST /api/studios/[id]/image`

#### –ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ:

- **Endpoint**: `POST /api/upload/video`
- **Body**: FormData —Å `videoFile`
- **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã**: MP4, WebM, OGG, AVI, MOV, QuickTime
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä**: 100MB

#### –ó–∞–≥—Ä—É–∑–∫–∞ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–æ–≤:

- **Endpoint**: `POST /api/upload/file`
- **Body**: FormData —Å:
  - `file`: —Ñ–∞–π–ª –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
  - `fileType`: 'image' | 'video' | 'audio' | 'document'
  - `folder`: –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### üåê URL —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

#### –û–±—ã—á–Ω—ã–π URL:

```
https://arcast-s3.blr1.digitaloceanspaces.com/images/studios/filename.jpg
```

#### CDN URL (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):

```
https://arcast-s3.blr1.cdn.digitaloceanspaces.com/images/studios/filename.jpg
```

### ‚ö° –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ CDN:

- **–ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** —Ñ–∞–π–ª–æ–≤ –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –Ω–∞ edge —Å–µ—Ä–≤–µ—Ä–∞—Ö
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∂–∞—Ç–∏–µ** –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **HTTPS** –ø–æ–¥–¥–µ—Ä–∂–∫–∞

### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

- ‚úÖ **–ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø** —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤** —Ñ–∞–π–ª–æ–≤
- ‚úÖ **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞** —Ñ–∞–π–ª–æ–≤
- ‚úÖ **–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞** —Ñ–∞–π–ª–æ–≤ (UUID)
- ‚úÖ **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ** –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

### üìä –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤:

| –¢–∏–ø —Ñ–∞–π–ª–∞   | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä | –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã              |
| ----------- | ------------------- | ----------------------------------- |
| –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | 5MB                 | JPEG, JPG, PNG, WebP                |
| –í–∏–¥–µ–æ       | 100MB               | MP4, WebM, OGG, AVI, MOV, QuickTime |
| –ê—É–¥–∏–æ       | 50MB                | MPEG, WAV, AAC, OGG                 |
| –î–æ–∫—É–º–µ–Ω—Ç—ã   | 10MB                | PDF, DOC                            |

### üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
npm run test:s3

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
npm run dev
```

### üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

#### –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç—É–¥–∏–∏:

```javascript
const formData = new FormData()
formData.append('imageFile', file)

const response = await fetch('/api/studios/studio-id/image', {
  method: 'POST',
  body: formData,
})
```

#### –ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ:

```javascript
const formData = new FormData()
formData.append('videoFile', videoFile)

const response = await fetch('/api/upload/video', {
  method: 'POST',
  body: formData,
})

const { videoUrl } = await response.json()
```

### üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env.local):

```env
AWS_REGION=blr1
AWS_ENDPOINT=https://blr1.digitaloceanspaces.com
AWS_ACCESS_KEY_ID=DO801ZANC8M4JR4ANL7Z
AWS_SECRET_ACCESS_KEY=R1umCcwzZQtooGLR1eccRTNh0KBVqrptLZVpWlEmZEo
AWS_S3_BUCKET_NAME=arcast-s3
```

### üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É** —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–æ—Ä–º—ã
2. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Space
4. **–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞:

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ: `npm run test:s3`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Space —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ DigitalOcean
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫–ª—é—á–µ–π
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–º–∏—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

---

## üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!

–í–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ DigitalOcean Spaces –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!
